
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
        <link rel="canonical" href="https://tomtalp.github.io/pyERGM/metrics/">
      
      
        <link rel="prev" href="../evaluating/">
      
      
        <link rel="next" href="../custom_metrics/">
      
      
        
      
      
      <link rel="icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.7.1">
    
    
      
        <title>Introduction to graph metrics - pyERGM</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.484c7ddc.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.ab4e12ef.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="blue" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#the-metric-class" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="pyERGM" class="md-header__button md-logo" aria-label="pyERGM" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            pyERGM
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Introduction to graph metrics
            
          </span>
        </div>
      </div>
    </div>
    
      
    
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
      <div class="md-header__source">
        <a href="https://github.com/tomtalp/pyERGM" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    pyERGM
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="pyERGM" class="md-nav__button md-logo" aria-label="pyERGM" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    pyERGM
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/tomtalp/pyERGM" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    pyERGM
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Home
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../overview/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Overview
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../fitting/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Fitting a model
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../evaluating/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Evaluating model performance
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" checked>
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Metrics
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            
  
    Metrics
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    
  
    Introduction to graph metrics
  

    
  </span>
  
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    
  
    Introduction to graph metrics
  

    
  </span>
  
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#the-metric-class" class="md-nav__link">
    <span class="md-ellipsis">
      
        The Metric class
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="The Metric class">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#examples" class="md-nav__link">
    <span class="md-ellipsis">
      
        Examples
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Examples">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#basic-metrics" class="md-nav__link">
    <span class="md-ellipsis">
      
        Basic metrics
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#metrics-with-multiple-statistics" class="md-nav__link">
    <span class="md-ellipsis">
      
        Metrics with multiple statistics
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#exogenous-metrics" class="md-nav__link">
    <span class="md-ellipsis">
      
        Exogenous metrics
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#a-collection-of-metrics" class="md-nav__link">
    <span class="md-ellipsis">
      
        A collection of metrics
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#collinearity-between-metrics" class="md-nav__link">
    <span class="md-ellipsis">
      
        Collinearity between metrics
      
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../metrics_reference.md" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    List of metrics
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../custom_metrics/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Creating custom metrics
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#the-metric-class" class="md-nav__link">
    <span class="md-ellipsis">
      
        The Metric class
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="The Metric class">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#examples" class="md-nav__link">
    <span class="md-ellipsis">
      
        Examples
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Examples">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#basic-metrics" class="md-nav__link">
    <span class="md-ellipsis">
      
        Basic metrics
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#metrics-with-multiple-statistics" class="md-nav__link">
    <span class="md-ellipsis">
      
        Metrics with multiple statistics
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#exogenous-metrics" class="md-nav__link">
    <span class="md-ellipsis">
      
        Exogenous metrics
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#a-collection-of-metrics" class="md-nav__link">
    <span class="md-ellipsis">
      
        A collection of metrics
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#collinearity-between-metrics" class="md-nav__link">
    <span class="md-ellipsis">
      
        Collinearity between metrics
      
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              
              <article class="md-content__inner md-typeset">
                
                  


  
  


  <h1>Introduction to graph metrics</h1>

<p>Calculating a statistics vectors for a graph, <span class="arithmatex">\(g(y)\)</span>, is a crucial component of ERGMs. 
Formally, <span class="arithmatex">\(g\)</span> is a function that receives a graph and returns a vector <span class="arithmatex">\(g(y) \in \mathbb{R}^q\)</span> with some statistics on that graph. These statistics can be as simple as counting the number of edges in the graph, calculating the number of triangles, or even more complex statistics that depend on exogenous variables for each node.</p>
<p>pyERGM provides a collection of metrics that can be used to calculate these statistics. These metrics are implemented as classes that inherit from the <code>Metric</code> class.</p>
<h2 id="the-metric-class">The <code>Metric</code> class</h2>
<p>Every metric in pyERGM is inherited from the <code>Metric</code> class, which defines the interface for calculating statistics on a graph. All metrics implement a <code>calculate</code> function, which receives a graph and returns the calculated statistics.</p>
<p><div class="highlight"><pre><span></span><code><span class="n">pyERGM</span><span class="o">.</span><span class="n">metrics</span><span class="o">.</span><span class="n">Metric</span><span class="o">.</span><span class="n">calculate</span><span class="p">(</span><span class="nb">input</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span> <span class="o">|</span> <span class="n">nx</span><span class="o">.</span><span class="n">Graph</span><span class="p">)</span>
</code></pre></div>
<strong>Parameters</strong>:</p>
<ul>
<li><strong>input</strong> (<em>np.ndarray | nx.Graph</em>) - The input graph for which to calculate the statistics. The graph can be represented as a numpy adjacency matrix or a <code>networkx</code> graph object.</li>
</ul>
<p><strong>Returns</strong>:</p>
<ul>
<li><strong>result</strong> (<em>np.ndarray</em>) - The calculated statistics vector of length <span class="arithmatex">\(q \geq 1\)</span>, depending on how many  statistics the metric returns.</li>
</ul>
<h3 id="examples">Examples</h3>
<h4 id="basic-metrics">Basic metrics</h4>
<p>As our first example, we will calculate two statistics for a directed graph with 4 nodes -</p>
<ul>
<li>The number of edges in the graph</li>
<li>The number of reciprocal edges in the graph (i.e. how many node pairs have reciprocal edges between them).</li>
</ul>
<div class="highlight"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">pyERGM.metrics</span><span class="w"> </span><span class="kn">import</span> <span class="n">NumberOfEdgesDirected</span><span class="p">,</span> <span class="n">TotalReciprocity</span>

<span class="c1"># Create a connectivity matrix for a directed graph with 4 nodes</span>
<span class="n">W</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span>
    <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
    <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
    <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
    <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
<span class="p">])</span>


<span class="n">num_edges</span> <span class="o">=</span> <span class="n">NumberOfEdgesDirected</span><span class="p">()</span>
<span class="n">total_reciprocity</span> <span class="o">=</span> <span class="n">TotalReciprocity</span><span class="p">()</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Number of edges: </span><span class="si">{</span><span class="n">num_edges</span><span class="o">.</span><span class="n">calculate</span><span class="p">(</span><span class="n">W</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Total reciprocity: </span><span class="si">{</span><span class="n">total_reciprocity</span><span class="o">.</span><span class="n">calculate</span><span class="p">(</span><span class="n">W</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div>
<p>Output:
<div class="highlight"><pre><span></span><code>Number of edges: 6
Total reciprocity: 1
</code></pre></div></p>
<p>As expected, the graph has 6 edges and 1 reciprocal edge between nodes 1 and 2.</p>
<h4 id="metrics-with-multiple-statistics">Metrics with multiple statistics</h4>
<p>As opposed to the <code>NumberOfEdgesDirected</code> metric which returns a scalar, some metrics return a vector of statistics. For example, the <code>InDegree</code> and <code>OutDegree</code> metrics calculate the indegrees and outdegrees of each node in the graph.</p>
<div class="highlight"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">pyERGM.metrics</span><span class="w"> </span><span class="kn">import</span> <span class="n">InDegree</span><span class="p">,</span> <span class="n">OutDegree</span>

<span class="n">indeg</span> <span class="o">=</span> <span class="n">InDegree</span><span class="p">()</span>
<span class="n">outdeg</span> <span class="o">=</span> <span class="n">OutDegree</span><span class="p">()</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;In-degree: </span><span class="si">{</span><span class="n">indeg</span><span class="o">.</span><span class="n">calculate</span><span class="p">(</span><span class="n">W</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Out-degree: </span><span class="si">{</span><span class="n">outdeg</span><span class="o">.</span><span class="n">calculate</span><span class="p">(</span><span class="n">W</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div>
<p>Output:
<div class="highlight"><pre><span></span><code>In-degree: [2 2 1 1]
Out-degree: [1 2 2 1]
</code></pre></div></p>
<h4 id="exogenous-metrics">Exogenous metrics</h4>
<p>So far we've seen metrics that are only based on the graph's connectivity matrix. However, there are many scenarios in which the graph nodes &amp; edges have additional attributes that are external to the connectivity matrix. For example, in a graph that represents a social network, each node might have an attribute representing the age of a person. These are called <strong>exogenous attributes</strong>. </p>
<p>The exogenous attributes are passed to the metric as a collection of external attributes. The order of these attributes should correspond to the node order in the connectivity matrix.</p>
<p>In the following example, we take a graph with 3 nodes, and assign a number to each node. We then wish to sum these attributes across nodes that are connected to each other. This is done using the <code>NodeAttrSum</code> metric.</p>
<div class="highlight"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">pyERGM.metrics</span><span class="w"> </span><span class="kn">import</span> <span class="n">NodeAttrSum</span>

<span class="n">W</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span>
    <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
    <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
    <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
<span class="p">])</span>

<span class="c1"># For each of the 3 nodes in W, we assign a number.</span>
<span class="c1"># The order of these attributes corresponds to the node order in the connectivity matrix.</span>
<span class="n">external_attributes</span> <span class="o">=</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">]</span>

<span class="n">node_attr_metric</span> <span class="o">=</span> <span class="n">NodeAttrSum</span><span class="p">(</span><span class="n">external_attributes</span><span class="p">,</span> <span class="n">is_directed</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Sum of attributes: </span><span class="si">{</span><span class="n">node_attr_metric</span><span class="o">.</span><span class="n">calculate</span><span class="p">(</span><span class="n">W</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div>
<p>Output:
<div class="highlight"><pre><span></span><code>Sum of attributes: [13]
</code></pre></div></p>
<p>Let's verify this calculation, by observing the attribute sum for every edge - </p>
<ul>
<li>Edge 1 <span class="arithmatex">\(\rightarrow\)</span> 2 : 2 + 1 = 3</li>
<li>Edge 2 <span class="arithmatex">\(\rightarrow\)</span> 1 : 1 + 2 = 3</li>
<li>Edge 3 <span class="arithmatex">\(\rightarrow\)</span> 1 : 5 + 2 = 7</li>
</ul>
<p>which sums up to 13.</p>
<h2 id="a-collection-of-metrics">A collection of metrics</h2>
<p>It is often the case that an ERGM uses more than a single metric. To facilitate this, pyERGM provides a <code>MetricsCollection</code> class that can be used to collect multiple metrics together.</p>
<p>When an ERGM is initialized, it receives a list of metrics. For example - </p>
<div class="highlight"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">pyERGM.metrics</span><span class="w"> </span><span class="kn">import</span> <span class="n">NumberOfEdgesUndirected</span><span class="p">,</span> <span class="n">NumberOfTriangles</span>
<span class="n">metrics</span> <span class="o">=</span> <span class="p">[</span><span class="n">NumberOfEdgesUndirected</span><span class="p">(),</span> <span class="n">NumberOfTriangles</span><span class="p">()]</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">ERGM</span><span class="p">(</span><span class="n">num_nodes</span><span class="p">,</span> <span class="n">metrics</span><span class="p">,</span> <span class="n">is_directed</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</code></pre></div>
<p>The <code>MetricsCollection</code> object is initialized behind the scenes by the ERGM constructor, and is used throughout the model's lifecycle to calculate the statistics vector for the graph.</p>
<h2 id="collinearity-between-metrics">Collinearity between metrics</h2>
<p>Collineraity is a common issue in regression models, where two or more variables have some form of linear relationship. The degree to which the variables are correlated varies from perfect collinearity, where a pair of variables is perfectly correlated, to weaker forms of collinearity, in which the variables are correlated but not perfectly so. Collinearity can lead to issues in the optimization process, as well as in the interpretation of the model's coefficients.</p>
<p>As an example, let's initialize a model with two metrics - one that counts the number of edges, and one that counts the degree of every node in the graph.</p>
<ol>
<li><code>NumberOfEdgesUndirected</code></li>
<li><code>UndirectedDegree</code></li>
</ol>
<div class="highlight"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">pyERGM.metrics</span><span class="w"> </span><span class="kn">import</span> <span class="n">NumberOfEdgesUndirected</span><span class="p">,</span> <span class="n">UndirectedDegree</span>

<span class="n">W</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span>
    <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
    <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
    <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
<span class="p">])</span>


<span class="n">num_edges</span> <span class="o">=</span> <span class="n">NumberOfEdgesUndirected</span><span class="p">()</span>
<span class="n">degrees</span> <span class="o">=</span> <span class="n">UndirectedDegree</span><span class="p">()</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Number of edges: </span><span class="si">{</span><span class="n">num_edges</span><span class="o">.</span><span class="n">calculate</span><span class="p">(</span><span class="n">W</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Degrees: </span><span class="si">{</span><span class="n">degrees</span><span class="o">.</span><span class="n">calculate</span><span class="p">(</span><span class="n">W</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div>
<p>Output:
<div class="highlight"><pre><span></span><code>Number of edges: 3
Degrees: [2, 1, 0]
</code></pre></div></p>
<p>In this example, there exists perfect collinearity between the number of edges and degree profile of all nodes in the graph. By definition, in an undirected graph the sum of degrees equals the number of edges, deeming one of these regressors to be redundant. This means that any regression model that includes all the 4 regressons will have perfect collinearity, which can lead to issues in the optimization process. </p>
<p>The most straightforward solution is to remove one of the conflicting metrics. pyERGM offers two ways to handle such issues - </p>
<p><strong>Automatic removal</strong> - The <code>MetricsCollection</code> class provides a tool for automatically detecting and removing collinear metrics. This is the default setting, and can be turned off with the <code>fix_collinearity=False</code> flag in the ERGM constructor. (<em>TODO - elaborate on the algorithm</em>).</p>
<p><strong>Manual removal</strong> - As the user building the model, you can manually remove metrics that you know are collinear. This can either be done in any of the following ways - </p>
<ol>
<li><ins>Removing a full metric</ins> - Removing the metric from the list of metrics passed to the ERGM constructor is the most straightforward way to fix collinearity, but it might not always be the best solution. In the example above, the <code>NumberOfEdgesUndirected</code> metric seems more informative than the <code>UndirectedDegree</code> metric, so completely removing it might not be desired.</li>
<li><ins>Ignoring a specific metric statistic</ins> - Metrics with more than a single statistic have an <code>indices_to_ignore</code> attribute that can be used to ignore specific statistics within the metric. It is a list of indices that should be ignored when calculating the statistics vector, and is passed when initializing the metric. 
The order of indices within the metric depends on the metric type - <ul>
<li>If the metric statistics depend only on the graph's connectivity matrix (e.g. <code>UndirectedDegree</code>), the indices correspond to the original ordering of the nodes in the graph. </li>
<li>If the metric statistics depend on exogenous attributes, the indices correspond to the lexicographic ordering of the exogenous attributes passed to the metric, i.e. <code>sorted(external_attributes)</code>.
In a metric such as <code>NumberOfEdgesTypesDirected</code> that creates statistics for type pairs, the ordering is the lexicographic ordering of the cartesian product of the node types. For example if <code>external_attributes=["A", "A", "B"]</code>, the metric will produce features for type pairs <code>["AA", "AB", "BA", "BB"]</code>, in a lexicographical ordering.</li>
</ul>
</li>
</ol>
<p>Let's see how we could have fixed the collinearity issue in the previous example.</p>
<p><strong>Automatic fixing</strong> - 
<div class="highlight"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">pyERGM.metrics</span><span class="w"> </span><span class="kn">import</span> <span class="n">NumberOfEdgesUndirected</span><span class="p">,</span> <span class="n">UndirectedDegree</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">pyERGM.metrics</span><span class="w"> </span><span class="kn">import</span> <span class="n">MetricsCollection</span>

<span class="n">W</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span>
    <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
    <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
    <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
<span class="p">])</span>

<span class="n">num_edges</span> <span class="o">=</span> <span class="n">NumberOfEdgesUndirected</span><span class="p">()</span>
<span class="n">degrees</span> <span class="o">=</span> <span class="n">UndirectedDegree</span><span class="p">()</span>

<span class="n">metrics</span> <span class="o">=</span> <span class="n">MetricsCollection</span><span class="p">(</span><span class="n">metrics</span><span class="o">=</span><span class="p">[</span><span class="n">num_edges</span><span class="p">,</span> <span class="n">degrees</span><span class="p">],</span> <span class="n">is_directed</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">n_nodes</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">fix_collinearity</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</code></pre></div></p>
<p>which will output - 
<div class="highlight"><pre><span></span><code>Removing the 0 feature of undirected_degree to fix multi-collinearity
</code></pre></div>
telling us that the 0-th idx feature of the <code>UndirectedDegree</code> metric was removed to fix the collinearity issue. We can also verify this by running - </p>
<div class="highlight"><pre><span></span><code><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Ignored features - &quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">metrics</span><span class="o">.</span><span class="n">get_ignored_features</span><span class="p">())</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Remaining features&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">metrics</span><span class="o">.</span><span class="n">get_parameter_names</span><span class="p">())</span>
</code></pre></div>
<p>with outputs -
<div class="highlight"><pre><span></span><code>Ignored features -
(&#39;undirected_degree_1&#39;,)
Remaining features
(&#39;num_edges_undirected&#39;, &#39;undirected_degree_2&#39;, &#39;undirected_degree_3&#39;)
</code></pre></div></p>
<p><strong>Ignoring the first statistic in</strong> <code>UndirectedDegree</code> -
<div class="highlight"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">pyERGM.metrics</span><span class="w"> </span><span class="kn">import</span> <span class="n">NumberOfEdgesUndirected</span><span class="p">,</span> <span class="n">UndirectedDegree</span>

<span class="n">W</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span>
    <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
    <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
    <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
<span class="p">])</span>

<span class="n">num_edges</span> <span class="o">=</span> <span class="n">NumberOfEdgesUndirected</span><span class="p">()</span>
<span class="n">degrees</span> <span class="o">=</span> <span class="n">UndirectedDegree</span><span class="p">(</span><span class="n">indices_to_ignore</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Number of edges: </span><span class="si">{</span><span class="n">num_edges</span><span class="o">.</span><span class="n">calculate</span><span class="p">(</span><span class="n">W</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Degrees: </span><span class="si">{</span><span class="n">degrees</span><span class="o">.</span><span class="n">calculate</span><span class="p">(</span><span class="n">W</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div></p>
<p>Output:
<div class="highlight"><pre><span></span><code>Number of edges: 3
Degrees: [1, 0]
</code></pre></div></p>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      
      <script id="__config" type="application/json">{"annotate": null, "base": "..", "features": [], "search": "../assets/javascripts/workers/search.2c215733.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../assets/javascripts/bundle.79ae519e.min.js"></script>
      
        <script src="../javascripts/mathjax.js"></script>
      
        <script src="https://unpkg.com/mathjax@3/es5/tex-mml-chtml.js"></script>
      
    
  </body>
</html>